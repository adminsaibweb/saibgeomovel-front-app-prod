import{L as u,J as I,N as s,aa as D,ah as L,O as S,ai as b,af as U,S as x,U as j,ac as v}from"./index-YngUMXNg.js";import{C as w,a as y}from"./card-CqYw-V1t.js";import{L as M}from"./label-CWpU4h0C.js";import{a as q}from"./currency-CxFzcO-j.js";import{u as F}from"./useLocalStorage-DOVSTlkF.js";import{F as G}from"./FieldSearch-B9AjKy8x.js";import"./calendar-NjMd2Ge-.js";import"./format-BBYAYFtJ.js";import"./startOfDay-Be0wd0F5.js";import"./addDays-CyOWDzeI.js";import"./chevron-down-DOs2cYKc.js";import"./popover-BjgOAWtL.js";import"./index-BFQh2s5u.js";import"./index-uC_SKFd_.js";import"./calendar-BYoEDV41.js";import"./pt-BR-mIVN-mbg.js";import"./input-jXGfHc8g.js";import"./hash-D4IGptF1.js";import"./check-FgXnpPwD.js";import"./clock-DtKml6_n.js";import"./chevron-up-CqDRigrW.js";import"./camera-CN1lv929.js";function ce(){const[a,c]=u.useState(null),[n,d]=u.useState(null),[o,g]=F("currentSearch"),m=o?.todasPesquisas,O=o?.cliente,R=I(),r=n?.PERGUNTAS?.findIndex(t=>t.GPP_ID===a.GPP_ID);function _(){const t=n?.PERGUNTAS[r];if(t.GPP_FLG_ORIGATORIA===1&&!t.RESPOSTA){x("Pergunta obrigatória não respondida");return}r!==-1&&r-1>=0&&c(n?.PERGUNTAS[r-1])}function C(){const t=n?.PERGUNTAS[r];if(t.GPP_FLG_ORIGATORIA===1&&!t.RESPOSTA){x("Pergunta obrigatória não respondida");return}r!==-1&&r+1<n?.PERGUNTAS?.length?c(n?.PERGUNTAS[r+1]):r!==-1&&r+1===n?.PERGUNTAS?.length&&R(-1)}async function A(t){const{pesquisa:e}=o??{},i={...n};i.PERGUNTAS||(i.PERGUNTAS=[]);const h=i.PERGUNTAS?.findIndex(l=>l.GPP_ID===t.GPP_ID);h!==-1&&(i.PERGUNTAS[h]=t),d(i);const E=i.PERGUNTAS.length,p=i.PERGUNTAS.filter(l=>l.RESPOSTA).length;e.QTDE_PERGUNTAS_RESPONDIDAS=p,e.PERCENTUAL_CONCLUIDO=q(100*p/E,0)+"%",e.CONCLUIDO=100*p/E,e.DETALHAMENTO[0]=i;const T=m.findIndex(l=>l.GFP_ID===e.GFP_ID);T!==-1&&(m[T]=e);const P=await j(),N=P.CLIENTES?.findIndex(l=>l.SEQ_PADRAO===O?.SEQ_PADRAO);N!==-1&&(P.CLIENTES[N].pesquisas=m),await v(P),e&&e?.DETALHAMENTO&&o.pesquisa&&o.pesquisa.DETALHAMENTO?o.pesquisa.DETALHAMENTO.length>0?(o.pesquisa.DETALHAMENTO=e.DETALHAMENTO,g({...o})):console.error("Erro: 'DETALHAMENTO' não contém elementos suficientes."):console.error("Erro: Variáveis necessárias não estão definidas corretamente.")}const f=u.useRef(!1);return u.useEffect(()=>{if(f.current)return;let e=o?.pesquisa?.DETALHAMENTO;e&&e.length>0&&(f.current=!0,d(e[0]),e=e[0].PERGUNTAS.filter(i=>i.GPP_FLG_STATUS===1),c(e[0]))},[]),s.jsxs("div",{className:"min-h-full background-pages pb-18",children:[s.jsx(D,{title:n?.GAP_DESCRICAO||"Em atendimento",showBackButton:!0,backPath:"/pesquisas-service"}),s.jsx("div",{className:"container mx-auto px-2 py-4 space-y-4 lg:pt-18",children:a&&s.jsxs(w,{className:"border-none shadow-lg overflow-hidden animate-in fade-in slide-in-from-bottom-4 duration-500 pt-0 gap-0",children:[s.jsx("div",{className:"h-3 bg-primary w-full"}),s.jsx(y,{className:"px-4 py-6 space-y-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs(M,{className:"text-base font-semibold text-zinc-700",children:[L(a?.GPP_PERGUNTA),a?.GPP_FLG_ORIGATORIA===1&&s.jsx("span",{className:"text-2xl font-bold text-red-500 ml-1",children:"*"})]}),s.jsx("div",{className:"flex w-full flex-col gap-3",children:a?.GPP_TIPO_CAMPO!==11&&a?.GPP_TIPO_CAMPO!==13?a?.CAMPOS?.map(t=>s.jsx(G,{typeField:a?.GPP_TIPO_CAMPO,data:t,search:a,onChange:e=>{c({...e}),A(e)}},t.GAC_ID)):s.jsx(G,{typeField:a?.GPP_TIPO_CAMPO,data:a,search:a,onChange:t=>{c({...t}),A(t)}})})]})})]})}),s.jsxs("div",{className:"fixed bottom-0 w-full left-0 right-0 p-4 bg-white border-t border-zinc-100 flex justify-between items-center z-20",children:[s.jsxs(S,{variant:"outline",onClick:_,disabled:r===0,className:"border-zinc-200 text-zinc-950 bg-transparent lg:ml-20",children:[s.jsx(b,{className:"h-4 w-4 mr-1"}),"Anterior"]}),s.jsxs(S,{onClick:C,className:"bg-linear-to-r from-primary to-primary hover:from-primary/90 hover:to-primary/90 text-white px-8 shadow-lg shadow-primary/25",children:["Próxima",s.jsx(U,{className:"h-4 w-4 ml-1"})]})]})]})}export{ce as default};
