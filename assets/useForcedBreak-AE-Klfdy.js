import{N as t,L as o}from"./index-YngUMXNg.js";import{T as b}from"./timer--7ll23NN.js";import{C as D}from"./clock-DtKml6_n.js";import{w as N,d as x}from"./timesAndDates-DyUV-en1.js";function h(e){const l=Math.floor(e/60),p=Math.floor(e%60);return`${l.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`}function F({stopWatch:e,interruptForced:l}){return e===null||l===0?null:t.jsxs(t.Fragment,{children:[l===1&&t.jsxs("div",{className:"w-full -mt-4 mb-4 overflow-hidden rounded-xl border border-purple-900/30 bg-purple-950 shadow-lg",children:[t.jsxs("div",{className:"flex items-start gap-3 p-4",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-purple-900 text-purple-300",children:t.jsx("i",{children:t.jsx(b,{size:20})})}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("h3",{className:"text-sm font-semibold text-purple-50",children:"Aviso de Pausa Obrigatória"}),t.jsx("p",{className:"text-xs text-purple-100",children:"O sistema será bloqueado em breve"})]})]}),t.jsxs("div",{className:"flex items-center justify-between bg-black/20 px-4 py-3 gap-1",children:[t.jsx("span",{className:"text-base font-medium text-purple-100",children:"Início em"}),t.jsx("span",{className:"font-mono text-xl font-bold tracking-wider text-purple-100",children:h(e)})]})]}),l===2&&t.jsxs("div",{className:"w-full -mt-4 mb-4 overflow-hidden rounded-xl border border-purple-900/30 bg-purple-950 shadow-lg",children:[t.jsxs("div",{className:"flex items-start gap-3 p-4",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-purple-900 text-purple-300",children:t.jsx("i",{children:t.jsx(D,{size:20})})}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("h3",{className:"text-sm font-semibold text-purple-50",children:"Sistema em Pausa Obrigatória"}),t.jsx("p",{className:"text-xs text-purple-100",children:"Aguarde para continuar atendimentos"})]})]}),t.jsxs("div",{className:"flex items-center justify-between bg-black/20 px-4 py-3 gap-1",children:[t.jsx("span",{className:"text-base font-medium text-purple-100",children:"Retorno em"}),t.jsx("span",{className:"font-mono text-xl font-bold tracking-wider text-purple-100",children:h(e)})]})]})]})}function T(e,l={}){const{onForcedBreakStart:p,onWarningEnd:I,onForcedBreakEnd:m}=l,[_,d]=o.useState(null),[c,S]=o.useState(0),u=o.useRef(null);async function H(){if(!e)return;let s=null,r=null;if(Object.keys(e?.HORARIOS_TRABALHO||{}).length!==0&&e?.HORARIOS_TRABALHO?.INICIO_PARADA1){const a=new Date,A=e?.HORARIOS_TRABALHO?.INICIO_PARADA1?.split(":",3);a.setHours(A[0],A[1],A[2]||0);const O=new Date,i=e?.HORARIOS_TRABALHO?.FIM_PARADA1?.split(":",3);O.setHours(i[0],i[1],i[2]||0),s=x(new Date,a),r=x(new Date,O)}let R=null,n=0;if(s!==null&&s/60>=-30&&s/60<=0&&e?.HORARIOS_TRABALHO?.FORCAR_PARADA1===1)R=Math.abs(s),n=1;else if(r!==null&&s!==null&&r/60<=0&&s/60>=0&&e?.HORARIOS_TRABALHO?.FORCAR_PARADA1===1)R=Math.abs(r),n=2;else if(Object.keys(e?.HORARIOS_TRABALHO||{}).length!==0&&e?.HORARIOS_TRABALHO?.INICIO_PARADA2){const a=new Date,A=e?.HORARIOS_TRABALHO?.INICIO_PARADA2?.split(":",3);a.setHours(A[0],A[1],A[2]||0);const O=new Date,i=e?.HORARIOS_TRABALHO?.FIM_PARADA2?.split(":",3);O.setHours(i[0],i[1],i[2]||0),s=x(new Date,a),r=x(new Date,O),e?.HORARIOS_TRABALHO?.FORCAR_PARADA2===1&&(s!==null&&s/60>=-30&&s/60<=0?(R=Math.abs(s),n=1):r!==null&&s!==null&&r/60<=0&&s/60>=0&&(R=Math.abs(r),n=2))}d(R),S(n),c!==2&&n===2&&p&&p(),c===2&&n!==2&&m&&m(),c===1&&n!==1&&I&&I()}const f=o.useRef(H);return o.useEffect(()=>{f.current=H}),o.useEffect(()=>!e||u.current?void 0:(N(new Date)==="Sábado"&&(e.HORARIOS_TRABALHO.INICIO_JORNADA=e?.HORARIOS_TRABALHO?.INICIO_JORNADA_SA,e.HORARIOS_TRABALHO.FIM_JORNADA=e?.HORARIOS_TRABALHO?.FIM_JORNADA_SA,e.HORARIOS_TRABALHO.INICIO_PARADA1=e?.HORARIOS_TRABALHO?.INICIO_PARADA1_SA,e.HORARIOS_TRABALHO.FIM_PARADA1=e?.HORARIOS_TRABALHO?.FIM_PARADA1_SA,e.HORARIOS_TRABALHO.FORCAR_PARADA1=e?.HORARIOS_TRABALHO?.FORCAR_PARADA1_SA),u.current=setInterval(()=>{f.current()},6e4),f.current(),()=>{u.current&&(clearInterval(u.current),u.current=null)}),[e]),o.useEffect(()=>{const s=setInterval(()=>{d(r=>r===null?r:r<=1?(setTimeout(()=>{f.current()},0),0):r-1)},1e3);return()=>clearInterval(s)},[]),{stopWatch:_,interruptForced:c,isBlocked:c===2}}export{F,T as u};
