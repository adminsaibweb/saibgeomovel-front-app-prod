import{I as D,V as A,R as O,L as m,U as V,N as e,a0 as T,aa as R,a1 as l}from"./index-YngUMXNg.js";import{u as v}from"./useQuery-PaZTN53n.js";import{C as N,a as j}from"./card-CqYw-V1t.js";import{a as p,F as _,c as C}from"./currency-CxFzcO-j.js";import{f as M}from"./format-BBYAYFtJ.js";import{p as S}from"./pt-BR-mIVN-mbg.js";import"./startOfDay-Be0wd0F5.js";const k=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],L=D("banknote",k);const E=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],P=D("receipt",E);async function B(h){try{if(A()){const d=await O.get("v1/trade/admin/financial/109/4277",{params:{cliente_id:h}}),{data:f,sucess:t}=d.data;if(t){const x=new Date;let o=[],s=[];return f.forEach(c=>{new Date(c.FIN_DATA_VCTO)<x?o.push(c):s.push(c)}),o=o.sort((c,i)=>new Date(c.FIN_DATA_VCTO)<new Date(i.FIN_DATA_VCTO)?-1:0),s=s.sort((c,i)=>new Date(c.FIN_DATA_VCTO)<new Date(i.FIN_DATA_VCTO)?-1:0),{contasVencidas:o,contasAReceber:s}}}}catch{return{contasVencidas:[],contasAReceber:[]}}}function Y(){const[h,u]=m.useState(!1),[d,f]=m.useState(null),[t,x]=m.useState(0);h||o();async function o(){try{const a=await V();f(a),u(!0)}catch(a){console.error("Erro ao buscar os dados do IndexedDB:",a)}}const{data:s,isPending:c}=v({queryKey:["getFinancial",d?.CLI_IN_PROGRESS],queryFn:async()=>await B(d?.CLI_IN_PROGRESS),enabled:!!d?.CLI_IN_PROGRESS}),i=s?.contasVencidas?.reduce((a,r)=>p(a)+p(r.FIN_VALOR),0),w=s?.contasAReceber?.reduce((a,r)=>p(a)+p(r.FIN_VALOR),0),b=m.useMemo(()=>{let a=[];t===0?a=s?.contasVencidas:a=s?.contasAReceber;const r={};return a?.forEach(n=>{const g=new Date(n.FIN_DATA_VCTO),F=g.getDate(),I=g.getMonth()+1,y=`${g.getFullYear()}-${I.toString().padStart(2,"0")}-${(F+1).toString().padStart(2,"0")}`;r[y]||(r[y]=[]),r[y].push(n)}),r},[s,t]);return c?e.jsx(T,{loadingTrue:!0}):e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"Financeiro",backPath:"/Admin",showBackButton:!0}),e.jsxs("div",{className:"flex w-full flex-col gap-4 p-4 lg:pt-18",children:[e.jsxs("section",{className:"grid w-full grid-cols-2 gap-4",children:[e.jsx(N,{onClick:()=>x(0),className:l("cursor-pointer transition-all hover:bg-gray-50 active:scale-95",t===0&&"bg-primary border-primary"),children:e.jsxs(j,{className:"flex flex-col items-center justify-center gap-2 p-4",children:[e.jsx(P,{size:32,className:t===0?"text-white":"text-primary"}),e.jsx("span",{className:l("text-lg font-bold text-gray-500",t===0&&"text-white"),children:"Vencidos"}),e.jsx("span",{className:l("text-lg font-bold",t===0?"text-white":"text-gray-900"),children:_(i)})]})}),e.jsx(N,{onClick:()=>x(1),className:l("cursor-pointer transition-all hover:bg-gray-50 active:scale-95",t===1&&"bg-primary border-primary"),children:e.jsxs(j,{className:"flex flex-col items-center justify-center gap-2 p-4",children:[e.jsx(L,{size:32,className:t===1?"text-white":"text-primary"}),e.jsx("span",{className:l("text-lg font-bold text-gray-500",t===1&&"text-white"),children:"A receber"}),e.jsx("span",{className:l("text-lg font-bold",t===1?"text-white":"text-gray-900"),children:_(w)})]})})]}),e.jsxs("div",{className:"flex w-full flex-col gap-4",children:[Object.values(b).length===0&&e.jsx("div",{className:"flex w-full justify-center p-4",children:e.jsx("span",{className:"text-xl font-bold text-zinc-700",children:"Nenhum registro encontrado"})}),Object.values(b).map((a,r)=>e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx("span",{className:"border-b border-gray-200 pb-2 text-lg font-bold text-gray-500",children:M(new Date(a[0].FIN_DATA_VCTO),"dd 'de' MMMM 'de' yyyy",{locale:S})}),e.jsx("div",{className:"flex flex-col gap-2",children:a.map(n=>e.jsx(N,{className:l("border-l-4",t===0?"border-l-red-500":"border-l-green-500"),children:e.jsxs(j,{className:"flex flex-col gap-1 p-4",children:[e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:C(n.FIN_VALOR)}),e.jsx("span",{className:"text-sm font-medium text-gray-500",children:n.FIN_TIPO_DOCUMENTO})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Nr. Doc: ",n.FIN_NUMERO_DOCUMENTO]}),n.Observacao&&e.jsx("span",{className:"text-sm text-gray-500 italic",children:n.Observacao})]})},n.FIN_ID))})]},r))]})]})]})}export{Y as default};
