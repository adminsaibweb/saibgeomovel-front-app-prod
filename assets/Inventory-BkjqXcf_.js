import{N as e,L as m,K as D,J as E,aa as I,a1 as h,U as b,S as C}from"./index-CYXlB6di.js";import{u as _}from"./index.esm-g7wEG1vX.js";import{A as v,a as S,b as R,c as y}from"./accordion-EzxeDEtF.js";import{F as O,a as L,b as w,c as T,d as A}from"./form-tFIv0F5k.js";import{I as P}from"./input-B9CoZ-jW.js";import{a as F}from"./card-CyEq7GHL.js";import{b as Q}from"./timesAndDates-BA0J74pm.js";import{B as $}from"./barcode-YvuBBTjE.js";import{H as B}from"./hash-B5v7kzv9.js";import{C as z}from"./calendar-t7hk2tVO.js";import{h as U}from"./order-Dck3wIJv.js";import{P as G}from"./package-CPoqMIl5.js";import"./index-DekvUVLv.js";import"./index-DSyZrcxj.js";import"./chevron-down-BrwHMvvE.js";import"./label-DZv4CB4a.js";import"./format-BBYAYFtJ.js";import"./startOfDay-Be0wd0F5.js";import"./addDays-CyOWDzeI.js";import"./pt-BR-mIVN-mbg.js";import"./apiEndpoints-aSQtSIWE.js";import"./handleApiError-Mr_6qIMG.js";function k({data:t,conf:i}){return e.jsxs(F,{className:"m-0 p-2 shadow-2xl shadow-primary",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-lg",children:"Quantidade"}),e.jsx("span",{className:"font-bold text-lg",children:t.QTDE})]}),e.jsxs("div",{className:"flex flex-col border-x border-gray-300 px-2",children:[e.jsx("span",{className:"text-lg",children:"Utilizado"}),e.jsx("span",{className:"font-bold text-lg",children:t.QTDE_UTILIZADA})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-lg",children:"Restante"}),e.jsx("span",{className:"font-bold text-lg",children:t.QTDE-t.QTDE_UTILIZADA})]})]}),e.jsxs("section",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("div",{className:"flex items-center justify-center p-2 rounded-full bg-gray-300",children:e.jsx($,{size:16})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:"Código de barras"}),e.jsx("span",{className:"font-bold text-sm",children:t.CODIGO_BARRAS})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("div",{className:"flex items-center justify-center p-2 rounded-full bg-gray-300",children:e.jsx(B,{size:16})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:"Série"}),e.jsx("span",{className:"font-bold text-sm",children:t.SERIE})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("div",{className:"flex items-center justify-center p-2 rounded-full bg-gray-300",children:e.jsx(z,{size:16})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:"Data de validade"}),e.jsx("span",{className:"font-bold text-sm",children:Q(t.DATA_VALIDADE,"dd/MM/yyyy")})]})]}),e.jsxs("div",{className:`mt-4 font-bold ${i?"text-green-500":"text-red-500"}`,children:["Conferido: ",i?"Sim":"Não"]})]})}function xe(){const[t,i]=m.useState([]),[x,N]=m.useState([]),o=_(),{watch:u}=o,{showLoading:j,hideLoading:f}=D(),g=E();async function p(){try{j();const s=await b(),a=s.CONFERENCE?s.CONFERENCE.PRODUCTS:[];let r=s.CONFERENCE;if(r&&(r=s.CONFERENCE.INVENTORY),(!r||r.length===0)&&(r=await U(s.CLI_IN_PROGRESS)),!r){C("Não foi possível buscar os dados, verifique sua conexão com a internet"),f(),g("/Admin");return}N(r),i(a)}catch{}finally{f()}}m.useEffect(()=>{p()},[]);const d=u("search")||"";let l=x?.sort(function(s,a){return s?.PROD_DESCR?.toLowerCase()>a?.PROD_DESCR?.toLowerCase()?1:-1});return l=x.filter(s=>d.includes(s.CODIGO_BARRAS)||s.PROD_DESCR.toLowerCase().includes(d.toLowerCase())||s.LOTE.toLowerCase().includes(d.toLowerCase())),e.jsxs(e.Fragment,{children:[e.jsx(I,{title:"Inventário",backPath:"/Admin",showBackButton:!0}),e.jsxs("div",{className:"flex w-full flex-col gap-4 p-4 lg:pt-18",children:[e.jsx(O,{...o,children:e.jsx("form",{className:"flex w-full flex-col gap-2",children:e.jsx(L,{control:o.control,name:"search",render:({field:s})=>e.jsxs(w,{children:[e.jsx(T,{children:"Produto"}),e.jsx(A,{children:e.jsx(P,{...s,placeholder:"Buscar produto..."})})]})})})}),l&&l.length>0&&e.jsx(v,{type:"single",collapsible:!0,className:"w-full flex flex-col gap-2",children:l.map(s=>{if(s.QTDE-s.QTDE_UTILIZADA!==0||t?.find(a=>a.ESIN_ID===s.ESIN_ID&&a.QTDE_LIDO!==0)){const a=t?.find(n=>n.ESIN_ID===s.ESIN_ID),r=a?.QTDE-a?.QTDE_LIDO,c=t?.some(n=>n.ESIN_ID===s.ESIN_ID&&n.QTDE_LIDO!==0);return e.jsxs(S,{value:`${s.ESIN_ID}_${s.PROD_ID}_${s.SERIE}_${s.LOTE}`,className:"border-b-0",children:[e.jsx(R,{className:h("flex items-center justify-between p-2 text-left bg-primary text-white rounded-t-md hover:no-underline",c&&"bg-green-600 hover:bg-green-700"),children:e.jsxs("div",{className:h("flex w-full flex-col gap-2 rounded-t-md p-1 text-white",r<0&&!c?"bg-red-500":!c&&"bg-transparent",c&&"bg-transparent"),children:[e.jsxs("div",{className:"flex items-center gap-2 text-white justify-start font-normal",children:[e.jsx(G,{size:16}),"Código: ",s.PROD_CODIGO]}),e.jsx("span",{className:"flex items-center justify-start font-bold",children:s.PROD_DESCR}),e.jsxs("span",{className:"flex items-center font-normal justify-start",children:["Lote: ",s.LOTE]}),c&&e.jsx("span",{className:"text-sm",children:"Produto Conferido"})]})}),e.jsx(y,{className:"border p-0 m-0 gap-0 border-t-0 rounded-b-md border-gray-200",children:e.jsx(k,{data:s,conf:t?.find(n=>n.ESIN_ID===s.ESIN_ID)})})]},`${s.ESIN_ID}_${s.PROD_ID}_${s.SERIE}_${s.LOTE}`)}else return e.jsx(e.Fragment,{})})}),(!l||l.length===0)&&e.jsx("div",{className:"flex w-full justify-center p-4",children:e.jsx("p",{className:"text-lg font-bold text-zinc-600",children:"Nenhum produto encontrado"})})]})]})}export{xe as default};
